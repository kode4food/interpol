<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>A Guide to Interpol</title>
  <link href='//fonts.googleapis.com/css?family=Roboto:400,400italic,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/css/normalize.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/wide.css">

</head>
<body>
  <div class="container">
    <h1>
      <a href="./">A Guide to Interpol</a>
    </h1>
  </div>
  <div class="container">
    <h2 id="data-in-interpol">Data in Interpol</h2>

<p>Interpol is designed to consume JSON, meaning that it will work well if you provide JavaScript Object graphs that could otherwise easily serialize to JSON.  Once you start adding prototypal inheritence and such, all bets are off.  Interpol will also ignore Functions in the data unless they&#39;re specially blessed as being Interpol-compatible.</p>

<h3 id="what-are-context-and-scope?">What are Context and Scope?</h3>

<p>A context is the Object that you provide to Interpol to be incorporated into a template.  By Object, we mean Object.  Arrays and other value types will not be accepted, that is unless you wrap them in an Object.  For example, this is a potential context:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">myContext</span> <span class="o">=</span> <span class="p">{</span> 
  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Fred&quot;</span><span class="p">,</span>
  <span class="s2">&quot;age&quot;</span><span class="o">:</span> <span class="mi">69</span><span class="p">,</span>
  <span class="s2">&quot;spouse&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Ethel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;age&quot;</span><span class="o">:</span> <span class="mi">47</span>
  <span class="p">},</span>
  <span class="s2">&quot;friends&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Ricky&quot;</span><span class="p">,</span>
      <span class="s2">&quot;age&quot;</span><span class="o">:</span> <span class="mi">39</span><span class="p">,</span>
      <span class="s2">&quot;spouse&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Lucy&quot;</span><span class="p">,</span>
        <span class="s2">&quot;age&quot;</span><span class="o">:</span> <span class="mi">45</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">};</span>
</code></pre></div>
<p>Now let&#39;s say you pass <code>myContext</code> into an Interpol template for processing. Since your initial scope would be the context itself, a template like this:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="s2">&quot;%name was %age&quot;</span>
</code></pre></div>
<p><a class="jsfid" href="http://jsfiddle.net/kode4food/yB336/">JSFiddle</a></p>

<p>Would display:</p>
<div class="highlight"><pre><code class="language-html" data-lang="html">Fred was 69
</code></pre></div>
<p>The variables would be resolved directly from the provided context.</p>

<h4 id="a-question-of-scope">A Question of Scope</h4>

<p>In order to avoid surprises, for any template or module, Interpol will never change its context during processing.  Instead, it will create new scopes and will introduce variables into those.  Those variables only exist for the duration of that scope.  So if you were to loop over Fred&#39;s friends, given your previous templating experience, you might expect this:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">for</span> <span class="n">friend</span> <span class="k">in</span> <span class="n">friends</span>
  <span class="s2">&quot;%name was %age&quot;</span>
<span class="k">end</span>
</code></pre></div>
<p><a class="jsfid" href="http://jsfiddle.net/kode4food/9pCzE/">JSFiddle</a></p>

<p>To display this:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">Ricky was 39
</code></pre></div>
<p><strong>But it doesn&#39;t!</strong>  So why does Interpol continue to display &quot;Fred was 69&quot;?  Because it is not switching to a new context.  Instead it&#39;s creating a new scope and introducing a new variable to that scope (friend).  But <code>name</code> and <code>age</code> are being resolved from the previous scope because scopes are nested.  You can correct this like so:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">for</span> <span class="n">friend</span> <span class="k">in</span> <span class="n">friends</span>
  <span class="n">friend</span> <span class="o">|</span> <span class="s1">&#39;%name was %age&#39;</span>
<span class="k">end</span>
</code></pre></div>
<p><a class="jsfid" href="http://jsfiddle.net/kode4food/JsLPZ/">JSFiddle</a></p>

<p>Now <code>name</code> and <code>age</code> will be resolved from the <code>friend</code> variable in the current scope.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">By the way, now you&#39;ve seen some Interpol keywords.  Specifically you&#39;ve seen three of the keywords required to create a loop (for, in, and end).  Looping will be discussed later in this Guide.  You&#39;ve also seen Interpolation in action.  That will also be discussed later in the Guide.
</code></pre></div>
<h3 id="reserved-words">Reserved Words</h3>

<p>Interpol reserves the following identifiers as keywords:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">and, as, def, else, end, export, false, for, from, gt, gr, gte, if, import, in, let, like, lt, le, lte, mod, nil, not, or, self, true, unless, when, where
</code></pre></div>
<p>Attempting to assign values to these keywords, or to retrieve them as variables, will result in parsing errors.</p>

<h3 id="literals">Literals</h3>

<p>Literals are values expressed in terms of themself, rather than by variable references.  So for example, if I talked about a variable <code>name</code> I would really be talking about whatever it is that name refers to.  In the case of Literals, they <em>are</em> the values.  Some might refer to literals as fixed, or atomic.  Examples of Literals might include: 3.14, &#39;Hello, World&#39;, and false.</p>

<h4 id="numbers">Numbers</h4>

<p>Numeric Literals in Interpol can only be represented as either real or integers, and only as decimals.  The following are acceptable numeric literals:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="mi">0</span>
<span class="mi">103</span>
<span class="mi">99</span><span class="o">.</span><span class="mi">995</span>
<span class="mi">19</span><span class="o">.</span><span class="mi">123</span><span class="n">e12</span>
<span class="mi">5</span><span class="o">.</span><span class="mi">32</span><span class="n">e</span><span class="o">-</span><span class="mi">5</span>
</code></pre></div>
<h4 id="strings">Strings</h4>

<p>Strings are a series of characters (letters and so on).  Interpol provides two ways to represent strings: simple and multi-line.</p>

<p>A simple string starts and ends with a single quote, and does not break across multiple lines:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="s1">&#39;This is a simple string&#39;</span>
</code></pre></div>
<p>A multi-line string starts and ends with a triple-quote (&#39;&#39;&#39;) and may include line breaks:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">This</span>
<span class="s1">string</span>
<span class="s1">spans</span>
<span class="s1">multiple</span>
<span class="s1">lines</span>
<span class="s1">&#39;&#39;&#39;</span>
</code></pre></div>
<h5 id="escaping">Escaping</h5>

<p>Strings allow special characters to be included using an escaping method (a leading backslash <code>\</code>).  These characters are ones that would be difficult to represent as part of the string, such as a single quote or an embedded newline.</p>

<table><thead>
<tr>
<th style="text-align: center">Escape</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: center">\\</td>
<td>A single backslash</td>
</tr>
<tr>
<td style="text-align: center">\&quot;</td>
<td>A double quote</td>
</tr>
<tr>
<td style="text-align: center">\&#39;</td>
<td>A single quote</td>
</tr>
<tr>
<td style="text-align: center">\b</td>
<td>Bell</td>
</tr>
<tr>
<td style="text-align: center">\f</td>
<td>Form-Feed</td>
</tr>
<tr>
<td style="text-align: center">\n</td>
<td>Unix Newline</td>
</tr>
<tr>
<td style="text-align: center">\r</td>
<td>Carriage Return</td>
</tr>
<tr>
<td style="text-align: center">\t</td>
<td>Tab</td>
</tr>
</tbody></table>

<h4 id="booleans">Booleans</h4>

<p>The value of a Boolean literal is either true or false, so that&#39;s how you write them: <code>true</code> or <code>false</code>.</p>

<h4 id="nil">Nil</h4>

<p><code>nil</code> is how one would represent the absence of a value.  Interpol coerces any JavaScript <code>null</code> or <code>undefined</code> value that it sees into a Nil.</p>

<h4 id="self">Self</h4>

<p><code>self</code> refers to the current scope.  There are two good reasons for this keyword.  First is that one can retrieve values from the provided context that may not adhere to Interpol&#39;s identifier naming requirements.  Second is that the current scope can be passed into a Partial, Function, or Interpolation as a parameter.</p>

<h3 id="identifiers">Identifiers</h3>

<p>An Identifier is a name that can be used to retrieve a variable or member.  Interpol Identifiers must start with one of the following characters: (a-zA-Z_$).  All characters thereafter may also include digits: (0-9).  Identifiers can not be any of the Interpol reserved words.</p>

<h3 id="operators">Operators</h3>

<h4 id="additive-(+,--)">Additive (+, -)</h4>

<p>The additive operators are <code>+</code> and <code>-</code>.</p>

<h4 id="multiplicative-(*,-/)">Multiplicative (*, /)</h4>

<p>The multiplicative operators are <code>*</code>, <code>/</code>, and <code>mod</code> (modulo)</p>

<h4 id="unary-(-,-not)">Unary (-, not)</h4>

<p>Only two traditional unary operators are supported.  They are <code>-</code> for numeric negation, and <code>not</code> for boolean <em>not</em> negation.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">-</span><span class="n">transactionAmount</span>
<span class="ow">not</span> <span class="n">happy</span>
</code></pre></div>
<h4 id="precedence-override">Precedence Override</h4>

<p>You can override the precedence by which expressions are evaluated by enclosing those expressions in parentheses <code>()</code>:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="p">(</span><span class="mi">28</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
</code></pre></div>
<h3 id="lists">Lists</h3>

<p>Lists are a sequence of like elements surrounded by square braces <code>[]</code> and separated by commas <code>,</code>.  The elements therein are either all individual expressions (vectors) or all name/value pairs (dictionaries).  Lists created in Interpol are immutable.</p>

<h4 id="expressions-(vectors)">Expressions (Vectors)</h4>

<p>Expression Lists are always exposed as an Array.  These lists can only be accessed by numerical index.  These indexes are zero-based, meaning the first element is accessed with 0, and so on.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">let</span> <span class="n">a</span> <span class="o">=</span> <span class="o">[</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">8</span><span class="o">]</span>      <span class="c1"># single item list containing the number 9</span>
<span class="n">let</span> <span class="n">b</span> <span class="o">=</span> <span class="o">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span> <span class="o">+</span> <span class="mi">12</span><span class="o">]</span>  <span class="c1"># two item list containing 5 and 21</span>

<span class="n">a</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>                 <span class="c1"># displays 9</span>
<span class="n">b</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span>                 <span class="c1"># displays 21</span>
</code></pre></div>
<h4 id="name/value-pairs-(dictionaries)">Name/Value Pairs (Dictionaries)</h4>

<p>Name/Value Lists are always exposed as a Dictionary.  The name must be a valid identifier, while the value is any valid expression.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">[</span>
  <span class="n">theMachine</span> <span class="o">=</span> <span class="s1">&#39;Deep Thought&#39;</span><span class="p">,</span>
  <span class="n">theAnswer</span> <span class="o">=</span> <span class="p">(</span><span class="mi">28</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
<span class="o">]</span>
<span class="c1"># Treated like a dictionary { theMachine: &#39;Deep Thought&#39;, theAnswer: 42 }</span>
</code></pre></div>
<h3 id="member-retrieval">Member Retrieval</h3>

<p>Like in JavaScript, membership expressions allow you to drill into an List&#39;s properties or elements.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">myList</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
<span class="n">myList</span><span class="o">[</span><span class="n">someIndex</span> <span class="ow">or</span> <span class="mi">0</span><span class="o">]</span>
<span class="n">myObject</span><span class="o">.</span><span class="n">someProperty</span>
<span class="n">myObject</span><span class="o">[</span><span class="s1">&#39;someProperty&#39;</span><span class="o">]</span>
</code></pre></div>
<h3 id="assignment">Assignment</h3>

<p>Interpol does not have a general-purpose assignment operator (like JavaScript&#39;s <code>=</code> operator).  Instead, it allows you to bind variables to the current scope only using the <code>let</code> statement.  This statement explicitly shadows any identically named variables from parent scopes.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">let</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="o">[</span><span class="nb">name</span> <span class="o">=</span> <span class="s1">&#39;Thom&#39;</span><span class="p">,</span> <span class="n">age</span> <span class="o">=</span> <span class="n">a</span><span class="o">]</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">b</span> <span class="o">|</span> <span class="s1">&#39;Howdy, %name&#39;</span>
</code></pre></div>
<p>You can also spread this across multiple lines, but the commas <em>must</em> be on the preceeding line:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">let</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
    <span class="n">b</span> <span class="o">=</span> <span class="o">[</span><span class="nb">name</span> <span class="o">=</span> <span class="s1">&#39;Thom&#39;</span><span class="p">,</span> <span class="n">age</span> <span class="o">=</span> <span class="n">a</span><span class="o">]</span><span class="p">,</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">b</span> <span class="o">|</span> <span class="s1">&#39;Howdy, %name&#39;</span>
</code></pre></div>
<h4 id="scope-creation">Scope Creation</h4>

<p>It&#39;s important then to know where new scopes are created in Interpol.  The following operations will automatically create a new scope:</p>

<ul>
<li>partial invocations</li>
<li><code>for</code> loops (except their <code>else</code> blocks)</li>
</ul>

  </div>
<div class="navigate">
  <span class="prev"><a href="01-intro.html">Previous Chapter</a></span>
  <span class="index"><a href="index.html">Table of Contents</a></span>
  <span class="next"><a href="03-html.html">Next Chapter</a></span>
</div>


</body>
</html>
